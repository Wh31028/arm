/*
 * ap.c
 *
 *  Created on: May 10, 2025
 *      Author: wh310
 */


#include "ap.h"


static void threadLed(void const *argument);


void apInit(void)
{
	uartOpen(_DEF_UART1, 57600);     //USB      (통신속도가 바뀌어서 통신이 안되지는 않음)
	uartOpen(_DEF_UART2, 57600);     //UART			(통신속도가 바뀌면 그에 맞춰서 데이터를 보내줘야함)

  cliOpen(_DEF_UART1, 57600);

  osThreadDef(threadLed, threadLed, _HW_DEF_RTOS_THREAD_PRI_LED, 0, _HW_DEF_RTOS_THREAD_MEM_LED);
 if (osThreadCreate(osThread(threadLed), NULL) != NULL)
 {
	 logPrintf("threadLed \t\t: OK\r\n");
 }
 else
 {
	 logPrintf("threadLed \t\t: Fail\r\n");
	 while(1);
 }
}

void apMain(void)
{
	while(1)
	{
		cliMain();
		delay(1);
	}
}

static void threadLed(void const *argument)
{
  UNUSED(argument);


  while(1)
  {
    ledToggle(_DEF_LED1);
    delay(2000);
  }
}
